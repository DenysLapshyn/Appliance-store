<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="www.thymeleaf.org/extras/spring-security" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Update item</title>
    <link href="/css/navbar.css" rel="stylesheet" type="text/css">
    <link href="/css/main-part.css" rel="stylesheet" type="text/css">
    <link href="/css/update-item.css" rel="stylesheet" type="text/css">
    <script src="/js/addRow.js"></script>
    <script src="/js/deleteRow.js"></script>
    <script src="/js/ensureFilesAreImages.js"></script>
    <script src="/js/ensureLogoIsImage.js"></script>
    <script src="/js/resetAddingForm.js"></script>
    <script src="/js/limitNumberOfUploadedFiles.js"></script>
    <script src="/js/concealLogoInput.js"></script>
    <script src="/js/concealImagesInput.js"></script>
</head>
<body>

<header>Admin</header>

<div th:replace="fragments/header :: siteHeader"></div>

<div class="main-part">
    <form th:action="@{/admin/update-item}" method="post" th:object="${updateItemDTO}" enctype="multipart/form-data">

        <div class="gray-text-label" th:text="#{update-item.updateItem}"></div>
        <br>

        <div class="update-item-grid">

            <!-- id -->
            <input type="hidden" name="id" th:field="*{id}" th:value="${updateItemDTO.getId()}">

            <!-- item name input -->
            <div>
                <label for="name" class="gray-text-label" th:text="#{update-item.itemName}"></label>
            </div>
            <div>
                <input name="name" id="name" type="text" class="text-field" placeholder="Enter item name"
                       th:field="*{name}" th:value="${updateItemDTO.getName()}" required>
                <div th:if="${#fields.hasErrors('name')}" th:errors="*{name}" class="red">Name errors</div>
            </div>

            <!-- price input -->
            <div>
                <label for="price" class="gray-text-label" th:text="#{update-item.price}"></label>
            </div>
            <div>
                <input name="price" id="price" type="text" class="text-field" placeholder="Enter price"
                       th:field="*{price}" th:value="${updateItemDTO.getPrice()}" required>
                <div th:if="${#fields.hasErrors('price')}" th:errors="*{price}" class="red">Price errors</div>
            </div>

            <!-- amount input -->
            <div>
                <label for="amount" class="gray-text-label" th:text="#{update-item.amount}"></label>
            </div>
            <div>
                <input name="amount" id="amount" type="text" class="text-field" placeholder="Enter amount"
                       th:field="*{amount}" th:value="${updateItemDTO.getAmount()}" required>
                <div th:if="${#fields.hasErrors('amount')}" th:errors="*{amount}" class="red">Amount errors</div>
            </div>

            <!-- description -->
            <div>
                <label for="description" class="gray-text-label" th:text="#{update-item.description}"></label>
            </div>
            <div>
                        <textarea name="description" id="description" rows="8" cols="50" placeholder="Enter description"
                                  class="text-field" th:field="*{description}"
                                  th:text="${updateItemDTO.getDescription()}"></textarea>
                <div th:if="${#fields.hasErrors('description')}" th:errors="*{description}" class="red">Description
                    errors
                </div>
            </div>

            <!-- logo -->
            <div>
                <label for="logo-input" class="gray-text-label" id="logo-label" th:text="#{update-item.chooseALogo}">
                </label>
            </div>
            <div>
                <label for="logo-input" id="logo-input-label" class="image-input-label"
                       th:text="#{update-item.chooseAnImageFile}">
                </label>
            </div>
            <div>
                <input name="logo" type="file" id="logo-input" class="display-none" accept="image/*"
                       onchange="ensureLogoIsImage(this)">
            </div>
            <!-- delete previous logo checkbox -->
            <div th:if="${updateItemDTO.getLogoName() != null}">
                <input type="checkbox" name="delete-previous-logo" id="delete-previous-logo"
                       onchange="concealLogoInput()">
                <label for="delete-previous-logo" class="gray-text-label"
                       th:text="#{update-item.deletePreviousLogo}"></label>
            </div>

            <!-- images -->
            <div>
                <label for="images-input" class="gray-text-label" id="images-label"
                       th:text="#{update-item.chooseImagesLabel}">
                </label>
            </div>
            <div>
                <label for="images-input" id="images-input-label" class="image-input-label"
                       th:text="#{update-item.chooseImagesButton}">
                </label>
            </div>
            <div>
                <input name="images" type="file" id="images-input" accept="image/*"
                       onchange="ensureFilesAreImages(this); limitNumberOfUploadedFiles(this, 10)"
                       class="display-none" multiple>
            </div>

            <!-- delete previous images checkbox -->
            <div th:if="${updateItemDTO.getImageNames() != null && updateItemDTO.getImageNames().size() > 0}">
                <input type="checkbox" name="delete-previous-images" id="delete-previous-images"
                       onchange="concealImagesInput()">
                <label for="delete-previous-images" class="gray-text-label"
                       th:text="#{update-item.deletePreviousImages}"></label>
            </div>

        </div>
        <br>

        <!-- specs input -->
        <div class="gray-text-label" th:text="#{update-item.specs}"></div>
        <div id="specsForm">
            <div th:each="spec : ${updateItemDTO.getSpecs()}">
                <input type="text" name="spec-names" class="text-field" th:value="${spec.key}"
                       placeholder="spec name">
                <input type="text" name="spec-values" class="text-field" th:value="${spec.value}"
                       placeholder="spec value">
                <button type="button" class="big-sign" onclick="deleteRow(this)">-</button>
                <br>
            </div>
            <!-- add button inserts here rows to create specs -->
        </div>

        <!-- this button adds a new row -->
        <button type="button" class="big-sign" onclick="addRow()">+</button>
        <br>

        <!-- reset button -->
        <input id="reset" type="reset" class="red-button" value="Reset" onclick="resetAddingForm()">
        <br>

        <!-- send button -->
        <input id="send" type="submit" class="green-button" value="Send">

    </form>
</div>

</body>
</html>