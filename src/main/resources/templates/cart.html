<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Cart</title>
    <link href="/css/navbar.css" rel="stylesheet" type="text/css">
    <link href="/css/main-part.css" rel="stylesheet" type="text/css">
    <script src="/js/increaseAmountToPurchase.js"></script>
    <script src="/js/decreaseAmountToPurchase.js"></script>
    <script src="/js/deleteOrderById.js"></script>
    <script src="/js/checkIfAllItemsInStockAndSendForm.js"></script>
</head>
<body>

<header>Cart</header>

<div th:replace="~{fragments/header :: siteHeader}"></div>

<div class="main-part">
    <form id="purchase-form" method="post" th:action="@{/cart/buy-orders}">

        <div class="gray-box margin" th:each="order: ${orders}">

            <!-- logo -->
            <img class="object-fit-contain"
                 height="90px"
                 th:if="${order.getItem().getLogoName() != null}" th:src="${logoFolder + order.getItem().getLogoName()}" width="90px"/>
            <!-- if logo is not present -->
            <img class="object-fit-contain" height="90px"
                 src="/images/default-logo-image" th:if="${order.getItem().getLogoName() == null}" width="90px"/>
            <br>

            <!-- item name -->
            <b><a th:href="${'/catalog/' + order.getItem().getId()}" th:text="${order.getItem().getName()}"></a></b>
            <br>

            <span th:text="#{cart.amountInStore}"></span>
            <span class="stored-amount" th:text="${order.getItem().getAmount()}"></span>
            <br>

            <span th:text="#{cart.amountToPurchase}"></span>
            <button class="small-sign" onclick="decreaseAmountToPurchase(this)" type="button">-</button>
            <span class="amount-to-purchase-label" th:text="${order.getAmount()}"></span>
            <input class="amount-to-purchase-field" name="amount_to_purchase" th:value="${order.getAmount()}"
                   type="hidden">
            <button class="small-sign" onclick="increaseAmountToPurchase(this)" type="button">+</button>
            <br>

            <div th:text="'Price: ' + ${order.getItem().getPrice()} + ' grn'"></div>

            <!-- delete item button (another form) -->
            <button class="red-button" th:onclick="'deleteOrderById(' + ${order.getId()} + ')'" th:text="#{cart.delete}"
                    type="button"></button>
        </div>

        <br>

        <!-- buy button -->
        <button class="green-button" form="purchase-form" onclick="checkIfAllItemsInStockAndSendForm()" th:if="${orders.size() > 0}"
                type="button">
            <span th:text="#{cart.buyOrders}"></span>
        </button>

    </form>
</div>

<!-- delete form -->
<form id="delete-order-form" method="post" th:action="@{/cart/delete-order}">
</form>
<br>

</body>
</html>