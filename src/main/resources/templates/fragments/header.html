<!DOCTYPE html>
<html lang="en"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Header Fragment</title>
    <link rel="stylesheet" th:href="@{/css/navbar.css}" type="text/css">
</head>
<body>

<!-- Header Fragment -->
<div th:fragment="siteHeader">

    <script th:inline="javascript">
        function changeLang(lang) {
            const url = new URL(window.location);
            url.searchParams.set('lang', lang);
            window.location.href = url.toString();
        }
    </script>

    <!-- Hidden logout form -->
    <form id="logout-form" method="post" th:action="@{/logout}">
    </form>

    <nav>
        <ul style="display: flex; list-style: none; gap: 1rem; padding: 0;">
            <li><a class="headerLink" th:href="@{/about}" th:text="#{about}"></a></li>

            <!-- Authenticated user -->
            <li sec:authorize="isAuthenticated()">
                <a class="headerLink" th:href="@{/profile}" th:text="#{profile}"></a>
            </li>

            <!-- ROLE_USER -->
            <li sec:authorize="hasRole('USER')">
                <a class="headerLink" th:href="@{/cart}" th:text="#{cart}"></a>
            </li>

            <!-- ROLE_ADMIN -->
            <li sec:authorize="hasRole('ADMIN')">
                <a class="headerLink" th:href="@{/admin}" th:text="#{admin}"></a>
            </li>

            <li><a class="headerLink" th:href="@{/catalog}" th:text="#{catalog}"></a></li>

            <!-- Logout button for authenticated users -->
            <li sec:authorize="isAuthenticated()">
                <button class="gray headerLink" form="logout-form" th:text="#{logout}" type="submit"></button>
            </li>

            <!-- Login / Registration for anonymous users -->
            <li sec:authorize="isAnonymous()">
                <a class="headerLink" th:href="@{/login}" th:text="#{login}"></a>
            </li>
            <li sec:authorize="isAnonymous()">
                <a class="headerLink" th:href="@{/registration}" th:text="#{register}"></a>
            </li>

            <!-- Spacer -->
            <li style="flex-grow: 1;"></li>

            <!-- Language switch -->
            <li><a class="headerLink" href="#" th:onclick="'changeLang(\'en\'); return false;'">English</a></li>
            <li><a class="headerLink" href="#" th:onclick="'changeLang(\'uk\'); return false;'">Українська</a></li>
        </ul>
    </nav>
    <br>
</div>

</body>
</html>